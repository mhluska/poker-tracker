{"mappings":"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","sources":["src/utils.ts","src/types.ts","src/state/app.ts","src/components/App.ts","src/lib/renderer.ts","src/components/BlindsButton.ts","src/components/IntroScreen.ts","src/components/NewSessionScreen.ts","src/components/NumberInput.ts","src/decorators/session.ts","src/models/session.ts","src/selectors/app.ts","src/components/ShowSessionScreen.ts","src/components/TipsSection.ts","src/constants.ts","src/index.ts","src/services/api.ts"],"sourcesContent":["import { PlainObject, Primitive } from './types';\n\n// See https://github.com/microsoft/TypeScript/pull/12253#issuecomment-353494273\nexport const keys = Object.keys as <T>(o: T) => (keyof T)[];\n\n// See https://stackoverflow.com/a/44078785/659910\nexport const uuid = () =>\n  Date.now().toString(36) + Math.random().toString(36).substring(2);\n\nexport const objectIsHtmlElement = (object: unknown): object is HTMLElement =>\n  !!(object as HTMLElement).tagName;\n\nexport const objectIsHtmlInputElement = (\n  object: unknown\n): object is HTMLInputElement => !!(object as HTMLInputElement).type;\n\nexport const formatDuration = (ms: number) => {\n  let seconds = ms / 1000;\n\n  const hours = Math.floor(seconds / 3600);\n  const minutes = Math.floor((seconds - hours * 3600) / 60);\n\n  seconds = Math.round(seconds - hours * 3600 - minutes * 60);\n\n  const hoursFormatted = hours < 10 ? `0${hours}` : hours.toString();\n  const minutesFormatted = minutes < 10 ? `0${minutes}` : minutes.toString();\n  const secondsFormatted = seconds < 10 ? `0${seconds}` : seconds.toString();\n\n  return `${hoursFormatted}:${minutesFormatted}:${secondsFormatted}`;\n};\n\nexport const isPlainObject = (object: unknown): object is PlainObject =>\n  typeof object === 'object' && !Array.isArray(object);\n\nexport const objectSet = (\n  object: PlainObject,\n  key: string,\n  value: Primitive\n) => {\n  if (!key) {\n    return;\n  }\n\n  const subKeys = key.split('.');\n  const lastKey = subKeys.pop();\n\n  if (!lastKey) {\n    return;\n  }\n\n  for (const key of subKeys) {\n    const next = object[key];\n    if (!isPlainObject(next)) {\n      return;\n    }\n\n    object = next;\n  }\n\n  object[lastKey] = value;\n};\n\nexport const capitalize = (str: string) =>\n  `${str[0].toUpperCase()}${str.slice(1)}`;\n\nexport const isCapitalized = (str: string) => str[0].toUpperCase() === str[0];\n\n// Works like `Date#toISOString()` but includes the client timezone.\n// See https://stackoverflow.com/a/17415677/659910\nexport const toISOString = (date: Date) => {\n  const tzo = -date.getTimezoneOffset();\n  const dif = tzo >= 0 ? '+' : '-';\n  const pad = (num: number) => (num < 10 ? '0' : '') + num;\n\n  return (\n    date.getFullYear() +\n    '-' +\n    pad(date.getMonth() + 1) +\n    '-' +\n    pad(date.getDate()) +\n    'T' +\n    pad(date.getHours()) +\n    ':' +\n    pad(date.getMinutes()) +\n    ':' +\n    pad(date.getSeconds()) +\n    dif +\n    pad(Math.floor(Math.abs(tzo) / 60)) +\n    ':' +\n    pad(Math.abs(tzo) % 60)\n  );\n};\n","export type Primitive = string | number | boolean | null | undefined;\n\nexport type PlainObject = {\n  [key: string]: Primitive | PlainObject | PlainObject[];\n};\n\nexport type Writeable<T> = { -readonly [P in keyof T]: T[P] };\n\nexport type ElementProperties = Writeable<\n  HTMLElementTagNameMap[keyof HTMLElementTagNameMap]\n>;\n\nexport enum Environments {\n  Development = 'development',\n  Production = 'production',\n}\n\nexport enum Screen {\n  Intro = 'intro',\n  NewSession = 'new-session',\n  ShowSession = 'show-session',\n}\n","import { Screen } from '../types';\n\nconst LOCAL_STORAGE_KEY = 'pokerTracker';\n\ntype SessionAttributes = {\n  id: string;\n  startTime?: string;\n  endTime?: string;\n  casinoName: string;\n  smallBlind: number;\n  bigBlind: number;\n  maxBuyin: number;\n  maxPlayers: number;\n  notes: string;\n  cashoutAmount: number;\n  drinkTips: number;\n  dealerTips: number;\n  buyins: { amount: number; time: string }[];\n};\n\nexport type AppState = {\n  screen: Screen;\n  currentSessionId?: string;\n  sessions: { [id: string]: SessionAttributes };\n  showSessionScreen: {\n    rebuyAmount: string;\n    notes: string;\n    cashoutAmount: string;\n    adminPassword: string;\n    isSavingSession: boolean;\n  };\n  newSessionScreen: {\n    casinoName: string;\n    smallBlind: string;\n    bigBlind: string;\n    maxBuyin: string;\n    maxPlayers: string;\n  };\n  cachedAdminPassword?: string;\n};\n\nconst locationToSessionId = () => {\n  const sessionPath = window.location.hash.match(/#\\/sessions\\/(.+)/);\n\n  if (sessionPath) {\n    return sessionPath[1];\n  }\n};\n\nconst sessionIdToScreen = (sessionId?: string) => {\n  if (!sessionId) {\n    return Screen.Intro;\n  }\n\n  if (sessionId === 'new') {\n    return Screen.NewSession;\n  }\n\n  return Screen.ShowSession;\n};\n\nconst loadAppState = (): AppState => {\n  const stateItem = window.localStorage.getItem(LOCAL_STORAGE_KEY);\n  const state = stateItem ? JSON.parse(stateItem) : {};\n  const sessionId = locationToSessionId();\n\n  return {\n    screen: sessionIdToScreen(sessionId),\n    sessions: {},\n    currentSessionId: sessionId,\n    showSessionScreen: {\n      rebuyAmount: '',\n      notes: '',\n      cashoutAmount: '',\n      adminPassword: '',\n      isSavingSession: false,\n    },\n    newSessionScreen: {\n      casinoName: '',\n      smallBlind: '',\n      bigBlind: '',\n      maxBuyin: '',\n      maxPlayers: '8',\n    },\n    ...state,\n  };\n};\n\nexport const app = loadAppState();\n\nexport const saveToLocalStorage = () => {\n  window.localStorage.setItem(\n    LOCAL_STORAGE_KEY,\n    JSON.stringify({\n      sessions: app.sessions,\n      // This is not very secure but I'm the only user of this hacky app.\n      // Long-term we would want JWT.\n      cachedAdminPassword: app.cachedAdminPassword,\n    })\n  );\n};\n","import { IntroScreen, NewSessionScreen, ShowSessionScreen } from '.';\nimport { Screen } from '../types';\nimport { appState } from '../state';\n\nexport const App = () => {\n  switch (appState.screen) {\n    case Screen.Intro:\n      return IntroScreen();\n    case Screen.NewSession:\n      return NewSessionScreen();\n    case Screen.ShowSession:\n      return ShowSessionScreen();\n    default:\n      return '';\n  }\n};\n","import { ElementProperties } from '../types';\nimport { isCapitalized, keys } from '../utils';\n\ntype CustomProperties = {\n  onInput: NonNullable<GlobalEventHandlers['oninput']>;\n};\n\ntype EventPropDescription = {\n  propName: keyof CustomProperties;\n  nativeEventName: string;\n  supportedElements: Set<keyof HTMLElementTagNameMap>;\n};\n\ntype VirtualElement = {\n  type: string;\n  tagName: keyof HTMLElementTagNameMap;\n  props: Partial<ElementProperties & CustomProperties>;\n  children: VirtualNode[];\n};\n\ntype VirtualNode = string | VirtualElement;\n\nconst ELEMENT_NODE_TYPE = 1;\nconst TEXT_NODE_TYPE = 3;\nconst ELEMENT_PROPERTIES = new Set(['value', 'className']);\nconst EVENT_PROPS: Record<string, EventPropDescription> = {\n  onInput: {\n    propName: 'onInput',\n    nativeEventName: 'input',\n    supportedElements: new Set(['input', 'select', 'textarea']),\n  },\n};\n\nconst isNativeElementType = (\n  type: string\n): type is keyof HTMLElementTagNameMap => !isCapitalized(type);\n\nconst elementType = (element: NonNullable<VirtualNode>) => {\n  return typeof element === 'string' ? 'string' : element.type;\n};\n\nexport const createVirtualElement = (\n  type: string,\n  props: VirtualElement['props'] | null = null,\n  ...children: VirtualElement['children']\n): VirtualElement => ({\n  type,\n  tagName: isNativeElementType(type)\n    ? type\n    : (props?.tagName as keyof HTMLElementTagNameMap),\n  props: props || {},\n  children,\n});\n\nexport const e = createVirtualElement;\n\nexport const createDomNode = (virtualNode: VirtualNode) => {\n  if (typeof virtualNode === 'string') {\n    return document.createTextNode(virtualNode);\n  }\n\n  const { tagName, props, children } = virtualNode;\n  const element = document.createElement(tagName);\n\n  if (props) {\n    for (const name of keys(props)) {\n      if (name === 'tagName') {\n        continue;\n      }\n\n      const value = props[name];\n\n      if (EVENT_PROPS[name]) {\n        if (EVENT_PROPS[name].supportedElements.has(tagName)) {\n          // TODO: Can we avoid a typecast here?\n          element.addEventListener(\n            EVENT_PROPS[name].nativeEventName,\n            value as EventListener\n          );\n          continue;\n        } else {\n          throw new Error(`Added onInput to invalid element type ${tagName}`);\n        }\n      }\n\n      if (ELEMENT_PROPERTIES.has(name)) {\n        // TODO: Figure out why an error related to readonly properties is\n        // happening despite using `Writeable`.\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        element[name] = value;\n      } else {\n        if (typeof value === 'boolean') {\n          if (value) {\n            element.setAttribute(name, '');\n          }\n        } else {\n          element.setAttribute(name, String(value));\n        }\n      }\n    }\n  }\n\n  for (const child of children) {\n    const childDomElement = createDomNode(child);\n\n    if (!childDomElement) {\n      continue;\n    }\n\n    element.appendChild(childDomElement);\n  }\n\n  return element;\n};\n\nconst reconcileEventHandlerProps = (\n  domNode: Element,\n  propName: keyof CustomProperties,\n  prevValue?: EventListener,\n  newValue?: EventListener\n) => {\n  if (prevValue) {\n    domNode.removeEventListener(\n      EVENT_PROPS[propName].nativeEventName,\n      prevValue\n    );\n  }\n\n  if (newValue) {\n    domNode.addEventListener(EVENT_PROPS[propName].nativeEventName, newValue);\n  }\n};\n\nexport const reconcileProps = (\n  domNode: Element,\n  prevNode: VirtualElement,\n  newNode: VirtualElement\n) => {\n  for (const name of keys(newNode.props).concat(keys(prevNode.props))) {\n    const prevValue = prevNode.props[name];\n    const newValue = newNode.props[name];\n\n    // HACK: With properties, our crappy virtal DOM can get out of sync after\n    // user input so we just always write.\n    if (ELEMENT_PROPERTIES.has(name)) {\n      // TODO: Fix type `Element` being too generic here.\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      domNode[name] = newValue === undefined ? '' : newValue;\n      continue;\n    }\n\n    if (prevValue === newValue) {\n      continue;\n    }\n\n    if (EVENT_PROPS[name]) {\n      // TODO: Can we avoid a typecast here?\n      reconcileEventHandlerProps(\n        domNode,\n        EVENT_PROPS[name].propName,\n        prevValue as EventListener | undefined,\n        newValue as EventListener | undefined\n      );\n      continue;\n    }\n\n    if (typeof newValue === 'boolean') {\n      if (newValue) {\n        domNode.setAttribute(name, '');\n      } else {\n        domNode.removeAttribute(name);\n      }\n    } else if (typeof newValue === 'undefined') {\n      domNode.removeAttribute(name);\n    } else {\n      domNode.setAttribute(name, String(newValue));\n    }\n  }\n};\n\nexport const reconcile = (\n  domNode: Element | null,\n  prevNode: VirtualNode,\n  newNode: VirtualNode,\n  parentElement: Element\n) => {\n  if (!domNode) {\n    parentElement.appendChild(createDomNode(newNode));\n    return;\n  }\n\n  if (prevNode && newNode) {\n    if (elementType(prevNode) !== elementType(newNode)) {\n      domNode.parentElement?.replaceChild(createDomNode(newNode), domNode);\n      return;\n    }\n\n    if (typeof prevNode === 'string') {\n      domNode.parentElement?.replaceChild(createDomNode(newNode), domNode);\n      return;\n    }\n\n    // This is certain because we check that both types are the same above but\n    // TypeScript is not smart enough to know that.\n    if (typeof newNode === 'string') {\n      return;\n    }\n\n    reconcileProps(domNode, prevNode, newNode);\n\n    newNode.children.forEach((newNodeChild, index) => {\n      reconcile(\n        Array.from(domNode.childNodes).filter(\n          (node) =>\n            node.nodeType === ELEMENT_NODE_TYPE ||\n            node.nodeType === TEXT_NODE_TYPE\n        )[index] as Element,\n        prevNode.children[index],\n        newNodeChild,\n        domNode\n      );\n    });\n  } else if (newNode) {\n    domNode.parentElement?.replaceChild(createDomNode(newNode), domNode);\n  } else if (prevNode) {\n    domNode.remove();\n  }\n};\n\nlet prevVirtualNode = e('div');\n\nexport const render = (component: VirtualNode, appRoot: HTMLElement | null) => {\n  if (!appRoot) {\n    throw new Error('appRoot is not set');\n  }\n\n  if (!appRoot.parentElement) {\n    throw new Error('appRoot not attached to DOM');\n  }\n\n  const virtualNode = e('div', null, component);\n  reconcile(appRoot, prevVirtualNode, virtualNode, appRoot.parentElement);\n\n  prevVirtualNode = virtualNode;\n};\n","import { e } from '../lib/renderer';\n\ntype Props = {\n  smallBlind: number;\n  bigBlind: number;\n};\n\nexport const BlindsButton = ({ smallBlind, bigBlind }: Props) =>\n  e(\n    'BlindsButton',\n    {\n      tagName: 'button',\n      type: 'button',\n      className: 'prefill-blinds',\n      'data-small-blind': smallBlind,\n      'data-big-blind': bigBlind,\n    },\n    `${smallBlind}/${bigBlind}`\n  );\n","import { e } from '../lib/renderer';\n\nexport const IntroScreen = () => {\n  return e(\n    'IntroScreen',\n    { tagName: 'div', id: 'intro-screen', className: 'screen' },\n    e('button', { id: 'new-session-button' }, 'Start Session')\n  );\n};\n","import { e } from '../lib/renderer';\nimport { NumberInput, BlindsButton } from '../components';\nimport { appState } from '../state';\n\nexport const NewSessionScreen = () => {\n  return e(\n    'NewSessionScreen',\n    { tagName: 'div', id: 'new-session-screen', className: 'screen' },\n    e(\n      'form',\n      { id: 'new-session-form' },\n      e(\n        'div',\n        null,\n        e(\n          'label',\n          null,\n          e('span', null, 'Casino Name'),\n          e('input', {\n            id: 'casino-name-input',\n            type: 'text',\n            placeholder: 'Bellagio',\n            required: true,\n            value: appState.newSessionScreen.casinoName,\n          })\n        )\n      ),\n      e(\n        'div',\n        null,\n        e(\n          'label',\n          null,\n          e('span', null, 'Blinds'),\n          NumberInput({\n            id: 'small-blind-input',\n            placeholder: '2',\n            value: appState.newSessionScreen.smallBlind,\n            max: 100,\n          }),\n          NumberInput({\n            id: 'big-blind-input',\n            placeholder: '5',\n            value: appState.newSessionScreen.bigBlind,\n            max: 200,\n          })\n        ),\n        BlindsButton({ smallBlind: 1, bigBlind: 2 }),\n        BlindsButton({ smallBlind: 1, bigBlind: 3 }),\n        BlindsButton({ smallBlind: 2, bigBlind: 5 }),\n        BlindsButton({ smallBlind: 5, bigBlind: 10 })\n      ),\n      e(\n        'div',\n        null,\n        e(\n          'label',\n          null,\n          e('span', null, 'Max Buyin'),\n          NumberInput({\n            id: 'max-buyin-input',\n            placeholder: '500',\n            value: appState.newSessionScreen.maxBuyin,\n          })\n        )\n      ),\n      e(\n        'div',\n        null,\n        e(\n          'label',\n          null,\n          e('span', null, 'Max Players'),\n          NumberInput({\n            id: 'max-players-input',\n            placeholder: '8',\n            max: 10,\n            value: appState.newSessionScreen.maxPlayers,\n          })\n        )\n      ),\n      e('div', null, e('input', { type: 'submit', value: 'Start Session' }))\n    )\n  );\n};\n","import { e } from '../lib/renderer';\n\ntype Props = {\n  id: string;\n  placeholder: string;\n  value?: string;\n  min?: number;\n  max?: number;\n};\n\nexport const NumberInput = ({ id, placeholder, value, min = 1, max }: Props) =>\n  e('NumberInput', {\n    tagName: 'input',\n    id,\n    type: 'number',\n    placeholder,\n    pattern: '\\\\d*',\n    value,\n    min,\n    max,\n    required: true,\n  });\n","import { Session as SessionModel } from '../models';\nimport { formatDuration } from '../utils';\n\nexport class Session {\n  session: SessionModel;\n\n  constructor(session: SessionModel) {\n    this.session = session;\n  }\n\n  drinkTips() {\n    return `$${this.session.attributes.drinkTips ?? 0}`;\n  }\n\n  dealerTips() {\n    return `$${this.session.attributes.dealerTips ?? 0}`;\n  }\n\n  blinds() {\n    return `${this.session.attributes.smallBlind}/${this.session.attributes.bigBlind}`;\n  }\n\n  maxBuyin() {\n    return `$${this.session.attributes.maxBuyin} max`;\n  }\n\n  title() {\n    return [\n      this.session.attributes.casinoName,\n      this.blinds(),\n      this.maxBuyin(),\n    ].join(' ');\n  }\n\n  startTime() {\n    return this.session.startTime?.toLocaleString() ?? '';\n  }\n\n  profit() {\n    const cashoutAmount = this.session.attributes.cashoutAmount ?? 0;\n    return (cashoutAmount - this.session.buyinsTotal()).toString();\n  }\n\n  timeElapsed() {\n    if (!this.session.startTime) {\n      return '';\n    }\n\n    return formatDuration(Date.now() - this.session.startTime.getTime());\n  }\n}\n","import { uuid, toISOString } from '../utils';\nimport { appState } from '../state';\n\nexport class Session {\n  id: string;\n\n  static create(\n    casinoName: string,\n    smallBlind: number,\n    bigBlind: number,\n    maxBuyin: number,\n    maxPlayers: number\n  ) {\n    const id = uuid();\n\n    appState.sessions[id] = {\n      id: uuid(),\n      casinoName,\n      smallBlind,\n      bigBlind,\n      maxBuyin,\n      maxPlayers,\n      notes: '',\n      cashoutAmount: 0,\n      dealerTips: 0,\n      drinkTips: 0,\n      buyins: [],\n    };\n\n    return new this(id);\n  }\n\n  constructor(id: string) {\n    this.id = id;\n\n    if (!this.attributes) {\n      throw new Error(`Session ${id} does not exist`);\n    }\n  }\n\n  get attributes() {\n    return appState.sessions[this.id];\n  }\n\n  get startTime() {\n    return this.attributes.startTime\n      ? new Date(this.attributes.startTime)\n      : null;\n  }\n\n  get endTime() {\n    return this.attributes.endTime ? new Date(this.attributes.endTime) : null;\n  }\n\n  start() {\n    if (this.startTime) {\n      throw new Error('Session already started');\n    }\n\n    if (this.endTime) {\n      throw new Error('Session already ended');\n    }\n\n    this.attributes.startTime = toISOString(new Date());\n    this.attributes.buyins.push({\n      amount: this.attributes.maxBuyin,\n      time: this.attributes.startTime,\n    });\n  }\n\n  rebuy(amount: number) {\n    this.attributes.buyins.push({\n      amount,\n      time: new Date().toISOString(),\n    });\n  }\n\n  rebuyMax() {\n    this.rebuy(this.attributes.maxBuyin);\n  }\n\n  end(cashoutAmount: number, notes: string) {\n    this.attributes.cashoutAmount = cashoutAmount;\n    this.attributes.endTime = toISOString(new Date());\n    this.attributes.notes = notes;\n  }\n\n  undoEnd() {\n    this.attributes.cashoutAmount = 0;\n    delete this.attributes.endTime;\n  }\n\n  buyinsTotal() {\n    return this.attributes.buyins.reduce(\n      (prev, current) => prev + current.amount,\n      0\n    );\n  }\n\n  updateTip(type: 'dealerTips' | 'drinkTips', change: number) {\n    if (this.attributes[type] + change < 0) {\n      return;\n    }\n\n    this.attributes[type] += change;\n  }\n\n  updateDealerTip(change: number) {\n    this.updateTip('dealerTips', change);\n  }\n\n  updateDrinkTip(change: number) {\n    this.updateTip('drinkTips', change);\n  }\n}\n","import { Session } from '../models';\nimport { appState, AppState } from '../state';\n\nclass Selectors {\n  appState: AppState;\n  _cachedCurrentSession?: Session;\n  _cachedCurrentSessionId?: string;\n\n  constructor(appState: AppState) {\n    this.appState = appState;\n  }\n\n  get currentSession() {\n    if (\n      this.appState.currentSessionId &&\n      this._cachedCurrentSessionId !== this.appState.currentSessionId\n    ) {\n      this._cachedCurrentSessionId = this.appState.currentSessionId;\n      this._cachedCurrentSession = new Session(this.appState.currentSessionId);\n    }\n\n    return this._cachedCurrentSession;\n  }\n}\n\nexport const selectors = new Selectors(appState);\n","import { e } from '../lib/renderer';\nimport { NumberInput, TipsSection } from '../components';\nimport { Session as SessionDecorator } from '../decorators';\nimport { appSelectors } from '../selectors';\nimport { appState } from '../state';\n\nexport const ShowSessionScreen = () => {\n  if (!appSelectors.currentSession) {\n    return '';\n  }\n\n  const session = new SessionDecorator(appSelectors.currentSession);\n\n  const handleNotesInput = (event: Event) => {\n    if (event.target) {\n      appState.showSessionScreen.notes = (<HTMLInputElement>event.target).value;\n    }\n  };\n\n  return e(\n    'ShowSessionScreen',\n    { tagName: 'div', id: 'show-session-screen', className: 'screen' },\n    e('h1', { id: 'session-title' }, session.title()),\n    e('div', null, e('span', null, `Profit: $${session.profit()}`)),\n    e('div', null, e('span', null, `Start time: $${session.startTime()}`)),\n    e('div', null, e('span', null, `Time elapsed: ${session.timeElapsed()}`)),\n\n    e(\n      'form',\n      { id: 'rebuy-form', className: 'section' },\n      NumberInput({\n        id: 'rebuy-amount-input',\n        placeholder: appSelectors.currentSession.attributes.maxBuyin.toString(),\n        max: appSelectors.currentSession.attributes.maxBuyin,\n        value: appState.showSessionScreen.rebuyAmount,\n      }),\n      e('input', { type: 'submit', value: 'Rebuy' }),\n      e('input', { id: 'rebuy-max-button', type: 'button', value: 'Max' })\n    ),\n\n    TipsSection({ type: 'dealer', value: session.dealerTips() }),\n    TipsSection({ type: 'drink', value: session.drinkTips() }),\n\n    e(\n      'form',\n      { id: 'end-session-form', className: 'section' },\n      e('input', {\n        className: 'hidden',\n        type: 'text',\n        autocomplete: 'username',\n      }),\n\n      e(\n        'label',\n        { className: 'section' },\n        e('div', null, 'Notes'),\n        e('textarea', {\n          placeholder: 'I punted again…',\n          onInput: handleNotesInput,\n        })\n      ),\n\n      e(\n        'label',\n        { className: 'section' },\n        e('div', null, 'Cashout Amount'),\n        NumberInput({\n          min: 0,\n          id: 'cashout-amount-input',\n          placeholder: (\n            appSelectors.currentSession.attributes.maxBuyin * 3\n          ).toString(),\n        })\n      ),\n\n      appState.cachedAdminPassword\n        ? ''\n        : e(\n            'div',\n            { id: 'admin-password-area' },\n            e('label', null, e('span', null, 'Password')),\n            e('input', {\n              id: 'admin-password-input',\n              type: 'password',\n              autocomplete: 'current-password',\n              required: true,\n            })\n          ),\n\n      e('input', {\n        id: 'end-session-submit-button',\n        type: 'submit',\n        value: 'End Session',\n        disabled: appState.showSessionScreen.isSavingSession,\n      })\n    )\n  );\n};\n","import { e } from '../lib/renderer';\nimport { capitalize } from '../utils';\n\ntype Props = {\n  type: 'dealer' | 'drink';\n  value: string;\n};\n\nexport const TipsSection = ({ type, value }: Props) =>\n  e(\n    'TipsSection',\n    { tagName: 'div', className: 'section' },\n    e('span', null, `${capitalize(type)} tips: ${value}`),\n    e(\n      'div',\n      null,\n      e(\n        'button',\n        { className: 'tip-button', id: `decrement-${type}-tip-button` },\n        '-'\n      ),\n      e(\n        'button',\n        { className: 'tip-button', id: `increment-${type}-tip-button` },\n        '+'\n      )\n    )\n  );\n","import { Environments } from './types';\n\nconst getEnvironment = () => {\n  if (window.location.hostname === 'localhost') {\n    return Environments.Development;\n  } else {\n    return Environments.Production;\n  }\n};\n\nexport const environment = getEnvironment();\n","import {\n  objectIsHtmlElement,\n  objectIsHtmlInputElement,\n  objectSet,\n} from './utils';\nimport { App } from './components';\nimport { render } from './lib/renderer';\nimport { Screen } from './types';\nimport { Api } from './services';\nimport { Session } from './models';\nimport { appState, saveToLocalStorage } from './state';\nimport { appSelectors } from './selectors';\n\nconst SAVE_APP_STATE_INTERVAL_MS = 10 * 1000;\n\nconst navigateToIntroScreen = () => {\n  window.history.pushState({}, '', '#');\n  appState.screen = Screen.Intro;\n};\n\nconst navigateToNewSessionScreen = () => {\n  window.history.pushState({}, '', '#/sessions/new');\n  appState.screen = Screen.NewSession;\n};\n\nconst navigateToShowSessionScreen = (session: Session) => {\n  window.history.pushState({}, '', `#/sessions/${session.id}`);\n  appState.currentSessionId = session.id;\n  appState.screen = Screen.ShowSession;\n};\n\nconst rebuy = () => {\n  if (!appSelectors.currentSession) {\n    return;\n  }\n\n  appSelectors.currentSession.rebuy(\n    parseFloat(appState.showSessionScreen.rebuyAmount)\n  );\n  appState.showSessionScreen.rebuyAmount = '';\n};\n\nconst createSession = () => {\n  const session = Session.create(\n    appState.newSessionScreen.casinoName,\n    parseInt(appState.newSessionScreen.smallBlind),\n    parseInt(appState.newSessionScreen.bigBlind),\n    parseInt(appState.newSessionScreen.maxBuyin),\n    parseInt(appState.newSessionScreen.maxPlayers)\n  );\n\n  session.start();\n\n  navigateToShowSessionScreen(session);\n};\n\nconst saveToGoogleSheet = async () => {\n  if (!appSelectors.currentSession) {\n    return;\n  }\n\n  appSelectors.currentSession.end(\n    parseFloat(appState.showSessionScreen.cashoutAmount),\n    appState.showSessionScreen.notes\n  );\n\n  appState.showSessionScreen.isSavingSession = true;\n\n  // TODO: Make this happen automatically on appState change.\n  render(App(), appRoot);\n\n  let response;\n\n  try {\n    response = await apiService.saveSession(\n      appSelectors.currentSession,\n      appState.cachedAdminPassword ?? appState.showSessionScreen.adminPassword\n    );\n  } finally {\n    appState.showSessionScreen.isSavingSession = false;\n\n    // TODO: Make this happen automatically on appState change.\n    render(App(), appRoot);\n  }\n\n  if (response.ok) {\n    if (!appState.cachedAdminPassword) {\n      appState.cachedAdminPassword = appState.showSessionScreen.adminPassword;\n    }\n\n    alert('Success!');\n    navigateToIntroScreen();\n  } else {\n    alert('Something went wrong.');\n\n    // TODO: Use changesets so we don't have to do this.\n    appSelectors.currentSession.undoEnd();\n  }\n};\n\nconst prefillBlinds = (smallBlind: string, bigBlind: string) => {\n  appState.newSessionScreen.smallBlind = smallBlind;\n  appState.newSessionScreen.bigBlind = bigBlind;\n};\n\nconst prefillMaxBuyin = (maxBuyin: string) => {\n  appState.newSessionScreen.maxBuyin = maxBuyin;\n};\n\nconst handleClick = (event: Event) => {\n  if (!objectIsHtmlElement(event.target)) {\n    return false;\n  }\n\n  switch (event.target.id) {\n    case 'new-session-button':\n      navigateToNewSessionScreen();\n      return true;\n    case 'decrement-dealer-tip-button':\n      appSelectors.currentSession?.updateDealerTip(-1);\n      return true;\n    case 'increment-dealer-tip-button':\n      appSelectors.currentSession?.updateDealerTip(1);\n      return true;\n    case 'decrement-drink-tip-button':\n      appSelectors.currentSession?.updateDrinkTip(-1);\n      return true;\n    case 'increment-drink-tip-button':\n      appSelectors.currentSession?.updateDrinkTip(1);\n      return true;\n    case 'rebuy-max-button':\n      appSelectors.currentSession?.rebuyMax();\n      return true;\n  }\n\n  if (\n    event.target.classList.contains('prefill-blinds') &&\n    event.target.dataset.smallBlind &&\n    event.target.dataset.bigBlind\n  ) {\n    prefillBlinds(\n      event.target.dataset.smallBlind,\n      event.target.dataset.bigBlind\n    );\n\n    prefillMaxBuyin((parseInt(event.target.dataset.bigBlind) * 100).toString());\n\n    return true;\n  }\n\n  return false;\n};\n\nconst handleAppClick = (event: Event) => {\n  if (handleClick(event)) {\n    // TODO: Make this happen automatically on appState change.\n    render(App(), appRoot);\n  }\n};\n\nconst handleSubmit = async (event: Event) => {\n  if (!objectIsHtmlElement(event.target)) {\n    return false;\n  }\n\n  event.preventDefault();\n\n  switch (event.target.id) {\n    case 'new-session-form':\n      createSession();\n      return true;\n    case 'rebuy-form':\n      rebuy();\n      return true;\n    case 'end-session-form':\n      await saveToGoogleSheet();\n      return true;\n  }\n\n  return false;\n};\n\nconst handleAppSubmit = async (event: Event) => {\n  if (await handleSubmit(event)) {\n    // TODO: Make this happen automatically on appState change.\n    render(App(), appRoot);\n  }\n};\n\nconst handleInput = (event: Event) => {\n  if (!objectIsHtmlInputElement(event.target)) {\n    return false;\n  }\n\n  const idToStateKey = (id: string) => {\n    switch (id) {\n      case 'casino-name-input':\n        return 'newSessionScreen.casinoName';\n      case 'small-blind-input':\n        return 'newSessionScreen.smallBlind';\n      case 'big-blind-input':\n        return 'newSessionScreen.bigBlind';\n      case 'max-buyin-input':\n        return 'newSessionScreen.maxBuyin';\n      case 'max-players-input':\n        return 'newSessionScreen.maxPlayers';\n      case 'rebuy-amount-input':\n        return 'showSessionScreen.rebuyAmount';\n      case 'cashout-amount-input':\n        return 'showSessionScreen.cashoutAmount';\n      case 'admin-password-input':\n        return 'showSessionScreen.adminPassword';\n    }\n  };\n\n  const key = idToStateKey(event.target.id);\n  if (!key) {\n    return false;\n  }\n\n  return objectSet(appState, key, event.target.value);\n};\n\nconst handleAppInput = (event: Event) => {\n  if (handleInput(event)) {\n    // TODO: Make this happen automatically on appState change.\n    render(App(), appRoot);\n  }\n};\n\nconst apiService = new Api();\nconst appRoot = document.getElementById('root');\n\nif (appRoot) {\n  appRoot.addEventListener('click', handleAppClick);\n  appRoot.addEventListener('submit', handleAppSubmit);\n  appRoot.addEventListener('input', handleAppInput);\n}\n\n// HACK: onbeforeunload doesn't seem to work on iOS so we save periodically.\nsetInterval(saveToLocalStorage, SAVE_APP_STATE_INTERVAL_MS);\ndocument.addEventListener('visibilitychange', saveToLocalStorage);\n\nwindow.onbeforeunload = saveToLocalStorage;\n\nrender(App(), appRoot);\n","import { Environments } from '../types';\nimport { Session } from '../models';\nimport { environment } from '../constants';\n\nexport class Api {\n  origin() {\n    if (environment === Environments.Development) {\n      return 'http://localhost:3000';\n    } else {\n      return 'https://blackjack-trainer-api.herokuapp.com';\n    }\n  }\n\n  request(path: string, body: unknown, requestOptions: RequestInit) {\n    const url = `${this.origin()}/api/v1${path}`;\n\n    return window.fetch(url, {\n      method: requestOptions.method,\n      headers: {\n        ...requestOptions.headers,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(body),\n    });\n  }\n\n  post(path: string, body: unknown, requestOptions: RequestInit) {\n    return this.request(path, body, { method: 'POST', ...requestOptions });\n  }\n\n  saveSession(session: Session, adminPassword: string) {\n    return this.post(\n      '/poker_sessions',\n      {\n        data: {\n          type: 'poker_session',\n          attributes: session.attributes,\n        },\n      },\n      {\n        headers: {\n          'Poker-Sessions-Admin-Password': adminPassword,\n        },\n      }\n    );\n  }\n}\n"],"names":["$df5bef30413a053b$export$ed97f33186d4b816","Object","keys","$df5bef30413a053b$export$31b40729666a4ae0","Date","now","toString","Math","random","substring","$df5bef30413a053b$export$c26d41fa6f97693c","object","tagName","$df5bef30413a053b$export$53b83ca8eaab0383","Array","isArray","$df5bef30413a053b$export$dfaaa8705752128f","date","tzo","getTimezoneOffset","dif","pad","num","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","floor","abs","$25746eb61037a613$export$56edef3a554a6277","$25746eb61037a613$export$a98515d67472a41f","$799ee1075ebfd49a$var$sessionIdToScreen","sessionId","NewSession","ShowSession","Intro","$799ee1075ebfd49a$export$729c8b7179294ba","stateItem","window","localStorage","getItem","state","JSON","parse","sessionPath","location","hash","match","$799ee1075ebfd49a$var$locationToSessionId","screen","sessions","currentSessionId","showSessionScreen","rebuyAmount","notes","cashoutAmount","adminPassword","isSavingSession","newSessionScreen","casinoName","smallBlind","bigBlind","maxBuyin","maxPlayers","$799ee1075ebfd49a$var$loadAppState","$799ee1075ebfd49a$export$1b8cd2d0ef9a8e5d","setItem","stringify","cachedAdminPassword","$a8e11eb2b4b0680a$export$86fbec116b87613f","$bfeb9d294d2ffc5c$export$327f2520b4698e84","$743ad4309d0f81b7$export$4f569ff5903d61c2","$be31a638e58516f0$export$596affaadba118e1","$0913f1c8cf9ffdbe$var$ELEMENT_PROPERTIES","Set","$0913f1c8cf9ffdbe$var$EVENT_PROPS","onInput","propName","nativeEventName","supportedElements","$0913f1c8cf9ffdbe$var$isNativeElementType","type","str","toUpperCase","$0913f1c8cf9ffdbe$var$elementType","element","$0913f1c8cf9ffdbe$export$f1e1789686576879","props","children","$0913f1c8cf9ffdbe$export$34d901be6c9525f9","virtualNode","document","createTextNode","createElement","name","value","has","addEventListener","Error","setAttribute","String","child","childDomElement","appendChild","$0913f1c8cf9ffdbe$var$reconcileEventHandlerProps","domNode","prevValue","newValue","removeEventListener","$0913f1c8cf9ffdbe$export$38319cad1f6d89e0","prevNode","newNode","parentElement","replaceChild","concat","undefined","removeAttribute","$0913f1c8cf9ffdbe$export$e1c2ac3e76b75bbd","forEach","newNodeChild","index","from","childNodes","filter","node","nodeType","remove","$0913f1c8cf9ffdbe$var$prevVirtualNode","$0913f1c8cf9ffdbe$export$b3890eb0ae9dca99","component","appRoot","$9ceabd904cf08d06$export$d7c54a71f8909529","className","id","placeholder","required","$7a7cb71cad4059ea$export$6bf0cd3a219bbade","max","min","pattern","$e7e206ea4712806d$export$1fb4852a55678982","constructor","session","this","drinkTips","attributes","dealerTips","blinds","title","join","startTime","toLocaleString","profit","buyinsTotal","timeElapsed","ms","seconds","hours","minutes","round","$df5bef30413a053b$export$bc733b0c5cbb3e8a","getTime","$959c11b99bd453e0$export$1fb4852a55678982","static","buyins","endTime","start","push","amount","time","rebuy","toISOString","rebuyMax","end","undoEnd","reduce","prev","current","updateTip","change","updateDealerTip","updateDrinkTip","$564d17351e22afa3$export$e1252723db1c541","appState","currentSession","_cachedCurrentSessionId","_cachedCurrentSession","$fdb14842a1041c3a$export$1e4a816d3f9032b4","autocomplete","event","target","disabled","slice","$9ecda7333d28e490$export$6bc7b24d4e862158","hostname","Development","Production","$b4e14b6b8da86996$var$createSession","create","parseInt","history","pushState","$b4e14b6b8da86996$var$navigateToShowSessionScreen","$b4e14b6b8da86996$var$saveToGoogleSheet","async","response","parseFloat","$b4e14b6b8da86996$var$appRoot","$b4e14b6b8da86996$var$apiService","saveSession","ok","alert","$b4e14b6b8da86996$var$handleClick","classList","contains","dataset","$b4e14b6b8da86996$var$handleAppClick","$b4e14b6b8da86996$var$handleSubmit","preventDefault","$b4e14b6b8da86996$var$handleAppSubmit","$b4e14b6b8da86996$var$handleInput","key","idToStateKey","subKeys","split","lastKey","pop","key1","next","$df5bef30413a053b$export$b6497f19c886af0e","$b4e14b6b8da86996$var$handleAppInput","origin","request","path","body","requestOptions","url","fetch","method","headers","post","data","getElementById","setInterval","onbeforeunload"],"version":3,"file":"index.6d2f2a1e.js.map"}